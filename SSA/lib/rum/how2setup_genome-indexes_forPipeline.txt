How to create indexes for the RUM pipeline:
------------------------------------------

Go to UCSC, choose the organism and assembly.
Go to Table Browser:

group: all tables
table: chromInfo
output format: selected fields from primary and related tables
output file: chromosome_sizes.txt
hit "get output" and choose the 'chrom' and 'size' fields.

Now remove the header line (if any) from chromosome_sizes.txt and add columns so rows look like this:

chr1    0       249250621       +
chr2    0       181748087	+
....

in other words, add a column with '0' between the chr and size cols, and add a col with '+' at the end

* The next steps get fasta file with the complete genome sequence.

Submit the file from the previous step to the genome browser as a custom track, then go to table browser
and set as follows:

group: custom tracks
track: User Track
region: genome
output format: sequence
output file: NAME_genome.txt
file type returned: gzip

where "NAME" should be replaced by something that identifies your name/assembly, eg mm9.
The scripts below won't work unless you follow this naming convention exactly.

Hit get output, and request all upper case

gunzip the file and run:

perl create_genome_indexes.pl NAME_genome.txt
------------------------------------------------------------------------------------
Now to make files of gene info and sequence:
 - you can use any of the annotation tracks as long as they have the five fields you
are asked to select below:
 - the following illustrates using two tracks "UCSC Known" and "RefSeq".  
 - If there are many annotation tracks, such as for mouse where there are more than ten,
   you probably shouldn't include them all, by default we have been using just three of
   them for mouse: refseq, ucsc and aceview.  Using all tracks would create a transcript
   db that is too complex, it's better to let blat map the reads for transcripts that
   are not present in the db rather than to expand the db too much with false transcripts.

Set the table browser as follows:

group: Genes and Gene Prediction Tracks
track: UCSC Genes (or whatever track you like)
table: knownGene (or whatever is the corresponding name for the track you chose)
region: genome
output format: selected fields from primary and related tables
output file: ucscknown.txt (keep the name of this file simple)

Hit "get output"

Select the following fields from the table:
name
chrom
strand
exonStarts
exonEnds

hit "get output".

Now do the same thing but get RefSeq genes, save to file called: refseq.txt
  - Set 'table' to be "refGene".

make a file called "gene_info_files" with one line per gene annotation filename:
--------------
refseq.txt
ucscknown.txt

Now run:

> perl create_gene_indexes.pl NAME_refseq_ucsc NAME_genome_one-line-seqs.fa
  - this is a master script that runs seven other scripts...
  - you will need a fair amount of RAM to do this, 10Gb was sufficient for Human

Now build bowtie indexes:

> bowtie-build NAME_refseq_ucsc_genes.fa NAME_genes
> bowtie-build NAME_genome_one-line-seqs.fa NAME_genome

The files you need to keep are the following 15:

NAME_refseq_ucsc_gene_info.txt
NAME_genome_one-line-seqs.fa
NAME_genes.4.ebwt
NAME_genes.3.ebwt
NAME_genes.2.ebwt
NAME_genes.1.ebwt
NAME_genes.rev.2.ebwt
NAME_genes.rev.1.ebwt
NAME_genome.4.ebwt
NAME_genome.3.ebwt
NAME_genome.2.ebwt
NAME_genome.1.ebwt
NAME_genome.rev.2.ebwt
NAME_genome.rev.1.ebwt
rum.config_NAME

Put all but rum.config_NAME in the indexes directory.  Put rum.config_NAME in the same
directory as the master script RUM_runner.pl.

 *** Note: edit rum.config_NAME if you have moved any scripts, executables, or indexes
     from their default locations.
